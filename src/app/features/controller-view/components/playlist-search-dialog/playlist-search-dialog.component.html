<div class="mat-dialog-header">
    <h2>Search playlists</h2>
    <button mat-icon-button (click)="syncPlaylists()" [disabled]="syncLoading" data-testid="syncPlaylistsBtn">
        <mat-icon>sync</mat-icon>
    </button>
</div>
<div mat-dialog-title class="search-container">
    <form (ngSubmit)="searchPlaylist()">
        <mat-form-field class="search-input">
            <mat-label>Search playlists...</mat-label>
            <input matInput [formControl]="searchPlaylistsInput" autocomplete="off" data-testid="searchPlaylistsInput">
        </mat-form-field>
    </form>
    <button mat-icon-button class="search-btn" (click)="searchPlaylist()" [disabled]="syncLoading"
        data-testid="searchSongsBtn">
        <mat-icon>search</mat-icon>
    </button>
</div>
<div mat-dialog-content class="playlists-container" (scroll)="onScroll($event)">
    <mat-accordion *ngIf="!loadingPlaylists && !syncLoading else loading" multi>
        <mat-expansion-panel *ngFor="let playlist of playlists" (click)="displayPlaylistSongs(playlist)"
            data-testid="expandPlaylistBtn">
            <mat-expansion-panel-header>
                <mat-panel-title>{{ playlist.title }}</mat-panel-title>
            </mat-expansion-panel-header>

            <div *ngIf="formattedPlaylist" class="formatted-playlist-songs">
                <p *ngFor="let song of formattedPlaylist.songs">
                    {{ song }}
                    <mat-divider></mat-divider>
                </p>
            </div>
            <div class="action-container">
                <button mat-flat-button color="primary" (click)="selectPlaylist(playlist)"
                    data-testid="selectPlaylistBtn">Select playlist</button>
            </div>
        </mat-expansion-panel>
    </mat-accordion>
    <ng-template #loading>
        <mat-spinner [diameter]="30"></mat-spinner>
    </ng-template>
</div>